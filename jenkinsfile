pipeline {
    agent any
    stages {
        stage('Build'){
            steps{
                   script {
                      docker.withRegistry('https://index.docker.io/v1/', 'dockerhub') {
                      def customImage = docker.build("nagham94/flask_app:0.0.0.1")
                      customImage.push()
                     }
                   }
               }
        }
        stage ('Testing'){
            agent{
                   docker{
                       image 'ubuntu:latest'
                   }
            }
            steps{
                echo 'testing..'
            }
        }
         stage ('Deploy'){
            input{
                message 'Do you want to run a container?'
            }
            steps{
                sh 'docker run -d --name flaskapp -p 5555:5000 nagham94/flask_app:0.0.0.1'
            }
        }
    }
}
